# Maestro - 在线五线谱创作家 🎼

Maestro 是一个基于 React、VexFlow 和 Google Gemini AI 构建的现代化网页版五线谱编辑器。它允许用户创作旋律、播放试听、本地保存，并利用 AI 生成音乐灵感。

## ✨ 已实现功能

### 🎹 创作与编辑
- **虚拟钢琴界面**：跨越 3 个八度 (C3-B5) 的可视化音符输入。
- **实时渲染**：使用 VexFlow 即时绘制标准的五线谱符号。
- **调号选择**：支持更改调号（如 G 大调，D 小调）并自动更新谱面显示。
- **音符控制**：支持多种时值（全音符、二分音符、四分音符、八分音符）。
- **休止符模式**：支持输入休止符而非音符。
- **临时变音记号**：支持升号 (#) 和降号 (b)。
- **编辑工具**：撤销上一步操作和清空画板功能。
- **反复记号**：在乐谱中添加开始 (`|:`) 和结束 (`:|`) 反复记号。

### 🤖 AI 集成
- **Gemini AI 作曲家**：根据自然语言描述生成旋律（例如：“D小调的悲伤旋律”）。
- **和弦建议**：智能分析当前旋律，由 AI 建议合适的和弦进行并标注在五线谱上。
- **自动转谱**：将 AI 返回的 JSON 数据直接转换为五线谱上的音符。

### 📂 乐谱库与存储
- **乐谱库**：内置经典预设，包括《权力的游戏》主题曲、《欢乐颂》等。
- **本地存储**：将您的创作保存到浏览器的本地存储中。
- **搜索与筛选**：按类别（原声带、古典、民谣、流行）筛选，或按标题/作曲家搜索。
- **管理**：删除自定义保存的乐谱。

### 🖨️ 导出、回放与练习
- **音频回放**：使用 Web Audio API 合成的正弦波音频回放。
- **节拍器**：内置可调节 BPM 的节拍器，支持在回放时同步打点，辅助练习。
- **打印优化**：专门的 CSS 样式用于高质量打印（隐藏 UI 元素，适配 A4 纸张）。

## 🛠️ 技术栈

- **前端**：React 19, TypeScript
- **样式**：Tailwind CSS
- **乐谱渲染**：VexFlow 5
- **AI**：Google GenAI SDK (Gemini 2.5 Flash)
- **图标**：Lucide React

## 🚀 构建与部署

本项目采用了 **无构建 (No-Build)** 设置，依赖 ES Modules 和 Import Maps。它直接运行在现代浏览器中，无需 Webpack 或 Vite 打包，保持简单轻量。

### 前置要求
- 现代网页浏览器 (Chrome/Edge/Firefox)。
- 一个静态文件服务器。

### 本地运行

1. **克隆或下载** 项目文件。
2. **在根目录启动静态服务器**。
   - 使用 Python:
     ```bash
     python3 -m http.server 8000
     ```
   - 使用 Node.js (`serve`):
     ```bash
     npx serve .
     ```
3. **打开浏览器**：访问 `http://localhost:8000`。

### 环境变量
要使用 AI 功能，应用程序通过 `process.env.API_KEY` 获取密钥。在没有打包工具的本地开发环境中，您可能需要暂时在 `services/geminiService.ts` 中硬编码您的密钥，或设置基本的构建流程来处理 `.env` 文件。

### 部署
由于应用是纯静态 HTML/JS/CSS：
1. 将所有文件上传到任何静态托管服务 (GitHub Pages, Netlify, Vercel, AWS S3)。
2. 确保 `metadata.json` 和目录结构保持在根目录。

## 📄 许可证
开源。